# --------------------------------------------------
# Redis config – tuned for geospatial performance
# --------------------------------------------------

bind 127.0.0.1
protected-mode yes
port 6379

# Keepalive untuk deteksi koneksi mati
tcp-keepalive 300

# Tingkat backlog koneksi tinggi untuk high throughput
tcp-backlog 65536

# Maksimum klien; sesuaikan jika banyak worker aplikasi
maxclients 20000

# Memory limit & eviction policy
maxmemory 200mb
maxmemory-policy allkeys-lru
maxmemory-samples 10

# Persistence (opsional, bisa nonaktif jika hanya caching geo)
save 900 1
save 300 10
save 60 10000
appendonly no

# Latency & slowlog monitoring
slowlog-log-slower-than 10000
slowlog-max-len 128

# Tuning IO threads (Redis ≥6)
io-threads-do-reads yes
io-threads 4

# Hz tuning
hz 10
dynamic-hz yes

# Geospatial tags (Redis built-in, modul opsional hapus komentar jika gunakan)
# loadmodule /usr/lib/redis/redis_geospatial.so

# Networking & eviction controls
timeout 0
tcp-backlog 65536

# Security
requirepass YOUR_SECURE_PASSWORD

# logfile & runtime
daemonize yes
loglevel notice
pidfile /var/run/redis/redis.pid
logfile "/var/log/redis/redis.log"

dir /var/lib/redis
dbfilename dump.rdb

# Scripts & Lua
lua-time-limit 5000
